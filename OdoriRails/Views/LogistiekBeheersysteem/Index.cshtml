@using OdoriRails.Models.LogistiekBeheer
@model OdoriRails.Models.LogistiekBeheer.LogistiekBeheerModel

<div class="container">
<div class="col-md-4 pull-left">
<div class="panel panel-default" style="margin-top: 10px">
    <div class="panel-heading">
        @Html.ActionLink("Main", "SetStateMain", null, new { @class = "btn btn-md btn-primary" })
        @Html.ActionLink("Edit", "SetStateEdit", null, new { @class = "btn btn-md btn-primary" })
        @Html.ActionLink("Delete", "SetStateDelete", null, new { @class = "btn btn-md btn-primary" })
        @Html.ActionLink("Simulation", "SetStateSimulation", null, new { @class = "btn btn-md btn-primary" })
    </div>
</div>
@if (Model.State == LogistiekState.Main)
{
    using (Html.BeginForm("LockTrack", "LogistiekBeheersysteem", FormMethod.Post))
    {
        <div class="panel panel-default" style="margin-top: -10px">
            <div class="panel-heading">
                @Html.Label("Lock/Unlock Track")
                <button type="submit" class="btn btn-md btn-primary pull-right" style="margin-top: -5px">Confirm</button>
            </div>
            <div class="panel-body">
                <table>
                    <tr>
                        <td>
                            @Html.Label("Track Numbers:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TrackNumbers)
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("Sector Numbers:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.SectorNumbers)
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("Lock:") @Html.RadioButtonFor(m => m.Form.RadioButton, new { id = 0 }, true)
                        </td>
                        <td>
                            @Html.Label("Unlock:") @Html.RadioButtonFor(m => m.Form.RadioButton, new { id = 1 }, true)
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    }
    using (Html.BeginForm("MoveTram", "LogistiekBeheersysteem", FormMethod.Post))
    {
        <div class="panel panel-default" style="margin-top: -10px">
            <div class="panel-heading">
                @Html.Label("Move Tram")
                <button type="submit" class="btn btn-md btn-primary pull-right" style="margin-top: -5px">Confirm</button>
            </div>
            <div class="panel-body">
                <table>
                    <tr>
                        <td>
                            @Html.Label("Tram Number:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TramNumber, new { type = "number" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("Track Number:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TrackNumber, new { type = "number" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("Sector Number:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.SectorNumber, new { type = "number" })
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    }
    using (Html.BeginForm("ToggleDisabled", "LogistiekBeheersysteem", FormMethod.Post))
    {
        <div class="panel panel-default" style="margin-top: -10px">
            <div class="panel-heading">
                @Html.Label("Disable/Enable Tram")
                <button type="submit" class="btn btn-md btn-primary pull-right" style="margin-top: -5px">Confirm</button>
            </div>
            <div class="panel-body">
                <table>
                    <tr>
                        <td>
                            @Html.Label("Tram Numbers:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TramNumbers)
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    }
}
else if (Model.State == LogistiekState.Edit)
{
    using (Html.BeginForm("AddTram", "LogistiekBeheersysteem", FormMethod.Post))
    {
        <div class="panel panel-default" style="margin-top: -10px">
            <div class="panel-heading">
                @Html.Label("Add Tram")
                <button type="submit" class="btn btn-md btn-primary pull-right" style="margin-top: -5px">Confirm</button>
            </div>
            <div class="panel-body">
                <table>
                    <tr>
                        <td>
                            @Html.Label("Tram Number:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TramNumber, new { type = "number" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("Default Line:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.DefaultLine, new { type = "number" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("Tram Model:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TramModel)
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    }
    using (Html.BeginForm("AddTrack", "LogistiekBeheersysteem", FormMethod.Post))
    {
        <div class="panel panel-default" style="margin-top: -10px">
            <div class="panel-heading">
                @Html.Label("Add Track")
                <button type="submit" class="btn btn-md btn-primary pull-right" style="margin-top: -5px">Confirm</button>
            </div>
            <div class="panel-body">
                <table>
                    <tr>
                        <td>
                            @Html.Label("Track Number:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TrackNumber, new { type = "number" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("Track Type:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TrackType)
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("Default Line:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.DefaultLine, new { type = "number" })
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    }
    using (Html.BeginForm("AddSector", "LogistiekBeheersysteem", FormMethod.Post))
    {
        <div class="panel panel-default" style="margin-top: -10px">
            <div class="panel-heading">
                @Html.Label("Add Sector")
                <button type="submit" class="btn btn-md btn-primary pull-right" style="margin-top: -5px">Confirm</button>
            </div>
            <div class="panel-body">
                <table>
                    <tr>
                        <td>
                            @Html.Label("Track Number:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TrackNumber, new { type = "number" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("Latitude:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.Latitude, new { type = "number" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            @Html.Label("Longitude")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.Longitude, new { type = "number" })
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    }
}
else
{
    using (Html.BeginForm("DeleteTram", "LogistiekBeheersysteem", FormMethod.Post))
    {
        <div class="panel panel-default" style="margin-top: -10px">
            <div class="panel-heading">
                @Html.Label("Delete Tram")
                <button type="submit" class="btn btn-md btn-primary pull-right" style="margin-top: -5px">Confirm</button>
            </div>
            <div class="panel-body">
                <table>
                    <tr>
                        <td>
                            @Html.Label("Tram Number:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TramNumber, new { type = "number" })
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    }
    using (Html.BeginForm("DeleteTrack", "LogistiekBeheersysteem", FormMethod.Post))
    {
        <div class="panel panel-default" style="margin-top: -10px">
            <div class="panel-heading">
                @Html.Label("Remove Track")
                <button type="submit" class="btn btn-md btn-primary pull-right" style="margin-top: -5px">Confirm</button>
            </div>
            <div class="panel-body">
                <table>
                    <tr>
                        <td>
                            @Html.Label("Track Number:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.TrackNumber, new { type = "number" })
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    }
    using (Html.BeginForm("DeleteSector", "LogistiekBeheersysteem", FormMethod.Post))
    {
        <div class="panel panel-default" style="margin-top: -10px">
            <div class="panel-heading">
                @Html.Label("Remove Last Sector")
                <button type="submit" class="btn btn-md btn-primary pull-right" style="margin-top: -5px">Confirm</button>
            </div>
            <div class="panel-body">
                <table>
                    <tr>
                        <td>
                            @Html.Label("Track Number:")
                        </td>
                        <td>
                            @Html.TextBoxFor(m => m.Form.SectorNumber, new { type = "number" })
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    }
}
</div>
    
<div class="col-md-8"> 
    <div style="border-radius: 4px; margin-top: 10px; height: 800px; width: 100%;" id="map"></div>
</div>
</div>
<script>
    var map;
    function initMap() {

        var myStyle = [
            {
                featureType: "administrative",
                elementType: "labels",
                stylers: [
                    { visibility: "off" }
                ]
            }, {
                featureType: "poi",
                elementType: "labels",
                stylers: [
                    { visibility: "off" }
                ]
            }, {
                featureType: "water",
                elementType: "labels",
                stylers: [
                    { visibility: "off" }
                ]
            }, {
                featureType: "road",
                elementType: "labels",
                stylers: [
                    { visibility: "off" }
                ]
            }
        ];

        console.log("initmap...");
        map = new google.maps.Map(document.getElementById('map'),
            {
            mapTypeControlOptions: {
                mapTypeIds: ['myStyle', google.maps.MapTypeId.ROADMAP, google.maps.MapTypeId.TERRAIN]
            },
            center: { lat: 52.348012, lng: 4.852770 },
            zoom: 18,
            draggable: false,
            scrollwheel: false,
            navigationControl: false,
            mapTypeControl: false,
            scaleControl: false,
            zoomControl: false,
            streetViewControl: false,
            mapTypeId: 'myStyle'
            });

        map.mapTypes.set('myStyle', new google.maps.StyledMapType(myStyle, { name: 'My Style' }));

        

        var marker;

        function addMarker(location, map, labeltext) {
            console.log("adding Marker!");
            // Add the marker at the clicked location, and add the next-available label
            // from the array of alphabetical characters.
            marker = new google.maps.Marker({
                position: location,
                label: labeltext,
                animation: google.maps.Animation.DROP,
                map: map,
                icon: "../../fonts/Icons/TransparantIcon16.gif"
            });
            marker.addListener('click', function () {
                infowindow.open(map, marker);
            });
        }
        //var coordinates = { lat: 52.348012, lng: 4.852770 };
        //addMarker(coordinates, map);

        var contentString;

        var infowindow = new google.maps.InfoWindow({
            content: contentString
        });

        var DocumentReady = function () {
            $.getJSON('/api/GoogleMapsAPI').done(RequestMethod);
            console.log("json read!");
        }

        var RequestMethod = function (data) {
            var long = $('#Longitude');
            var lat = $('#Latitude');
            var line = $('#Line');
            var tracknumber = $('#TrackNumber');
            var tramnumber = $('#TramNumber');
            var tracktype = $('#TrackType');
            var sectornumber = $('#SectorNumber');
            for (var i = 0; i < data.length; i++) {
                var location = { lat, long }
                addMarker(location, map, tramnumber);
                contentString = '<div id="content">' +
                    '<div id="siteNotice">' +
                    '</div>' +
                    '<h1 id="firstHeading" class="firstHeading">' +
                    'temp' +
                    '</h1>' +
                    '<div id="bodyContent">' +
                    '<p>Tracknumber: ' +
                    tracknumber +
                    '</p>' +
                    '<p>Tracktype: ' +
                    tracktype +
                    '</p>' +
                    '<p>Sectornumber: ' +
                    sectornumber +
                    '</p>' +
                    '<p>Line: ' +
                    line +
                    '</p>' +
                    '</div>' +
                    '</div>';
            }
        }

        $(document).ready(DocumentReady);
    }



    
</script>
    <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD4qb6olqxSBOg_yeccMF6MFjzNf9RCZ9s&callback=initMap"></script>